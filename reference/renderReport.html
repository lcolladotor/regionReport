<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate a HTML/PDF report exploring a set of genomic regions — renderReport • regionReport</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generate a HTML/PDF report exploring a set of genomic regions — renderReport"><meta property="og:description" content="This function generates a HTML report with quality checks, genome location
exploration, and an interactive table with the results. Other output formats
are possible such as PDF but lose the interactivity. Users can easily append
to the report by providing a R Markdown file to customCode, or can
customize the entire template by providing an R Markdown file to
template."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">regionReport</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.41.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/regionReport.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/bumphunterExample.html">Example report using bumphunter results</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/leekgroup/regionReport/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate a HTML/PDF report exploring a set of genomic regions</h1>
    <small class="dont-index">Source: <a href="https://github.com/leekgroup/regionReport/blob/devel/R/renderReport.R" class="external-link"><code>R/renderReport.R</code></a></small>
    <div class="hidden name"><code>renderReport.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function generates a HTML report with quality checks, genome location
exploration, and an interactive table with the results. Other output formats
are possible such as PDF but lose the interactivity. Users can easily append
to the report by providing a R Markdown file to <code>customCode</code>, or can
customize the entire template by providing an R Markdown file to
<code>template</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">renderReport</span><span class="op">(</span></span>
<span>  <span class="va">regions</span>,</span>
<span>  project <span class="op">=</span> <span class="st">""</span>,</span>
<span>  pvalueVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`P-values` <span class="op">=</span> <span class="st">"pval"</span><span class="op">)</span>,</span>
<span>  densityVars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  significantVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span><span class="op">$</span><span class="va">pval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>,</span>
<span>  annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nBestRegions <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  customCode <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"regionExploration"</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"regionExploration"</span>,</span>
<span>  browse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  txdb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"png"</span>,</span>
<span>  densityTemplates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Pvalue <span class="op">=</span> <span class="va">templatePvalueDensity</span>, Common <span class="op">=</span> <span class="va">templateDensity</span>,</span>
<span>    Manhattan <span class="op">=</span> <span class="va">templateManhattan</span><span class="op">)</span>,</span>
<span>  template <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">templatePvalueDensity</span></span>
<span></span>
<span><span class="va">templateDensity</span></span>
<span></span>
<span><span class="va">templateManhattan</span></span>
<span></span>
<span><span class="va">templatePvalueHistogram</span></span>
<span></span>
<span><span class="va">templateHistogram</span></span></code></pre></div>
    </div>

    <div id="format">
    <h2>Format</h2>
    <p>An object of class <code>character</code> of length 1.</p>
<p>An object of class <code>character</code> of length 1.</p>
<p>An object of class <code>character</code> of length 1.</p>
<p>An object of class <code>character</code> of length 1.</p>
<p>An object of class <code>character</code> of length 1.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-regions">regions<a class="anchor" aria-label="anchor" href="#arg-regions"></a></dt>
<dd><p>The set of genomic regions of interest as a <code>GRanges</code>
object. All sequence lengths must be provided.</p></dd>


<dt id="arg-project">project<a class="anchor" aria-label="anchor" href="#arg-project"></a></dt>
<dd><p>The title of the project.</p></dd>


<dt id="arg-pvaluevars">pvalueVars<a class="anchor" aria-label="anchor" href="#arg-pvaluevars"></a></dt>
<dd><p>The names of the variables with values between 0 and 1 to
plot density values by chromosome and a table for commonly used cutoffs.
Most commonly used to explore p-value distributions. If a named
character vector is provided, the names are used in the plot titles.</p></dd>


<dt id="arg-densityvars">densityVars<a class="anchor" aria-label="anchor" href="#arg-densityvars"></a></dt>
<dd><p>The names of variables to use for making density plots
by chromosome. Commonly used to explore scores and other variables given
by region.  If a named character vector is provided, the names are used in
the plot titles.</p></dd>


<dt id="arg-significantvar">significantVar<a class="anchor" aria-label="anchor" href="#arg-significantvar"></a></dt>
<dd><p>A <code>logical</code> variable differentiating statistically
significant regions from the rest. When provided, both types of regions
are compared against each other to see differences in width, location, etc.</p></dd>


<dt id="arg-annotation">annotation<a class="anchor" aria-label="anchor" href="#arg-annotation"></a></dt>
<dd><p>The output from <a href="https://rdrr.io/pkg/bumphunter/man/matchGenes.html" class="external-link">matchGenes</a> used on
<code>regions</code>. Note that this can take time for a large set of regions
so it's better to pre-compute this information and save it.</p></dd>


<dt id="arg-nbestregions">nBestRegions<a class="anchor" aria-label="anchor" href="#arg-nbestregions"></a></dt>
<dd><p>The number of regions to include in the interactive
table.</p></dd>


<dt id="arg-customcode">customCode<a class="anchor" aria-label="anchor" href="#arg-customcode"></a></dt>
<dd><p>An absolute path to a child R Markdown file with code to be
evaluated before the reproducibility section. Its useful for users who want
to customize the report by adding conclusions derived from the data and/or
further quality checks and plots.</p></dd>


<dt id="arg-outdir">outdir<a class="anchor" aria-label="anchor" href="#arg-outdir"></a></dt>
<dd><p>The name of output directory.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>The name of output HTML file (without the html extension).</p></dd>


<dt id="arg-browse">browse<a class="anchor" aria-label="anchor" href="#arg-browse"></a></dt>
<dd><p>If <code>TRUE</code> the HTML report is opened in your browser once
it's completed.</p></dd>


<dt id="arg-txdb">txdb<a class="anchor" aria-label="anchor" href="#arg-txdb"></a></dt>
<dd><p>Specify the transcription database to use for identifying the
closest genes via <a href="https://rdrr.io/pkg/bumphunter/man/matchGenes.html" class="external-link">matchGenes</a>. If <code>NULL</code> it will
use TxDb.Hsapiens.UCSC.hg19.knownGene by default.</p></dd>


<dt id="arg-device">device<a class="anchor" aria-label="anchor" href="#arg-device"></a></dt>
<dd><p>The graphical device used when knitting. See more at
<a href="http://yihui.name/knitr/options" class="external-link">http://yihui.name/knitr/options</a> (<code>dev</code> argument).</p></dd>


<dt id="arg-densitytemplates">densityTemplates<a class="anchor" aria-label="anchor" href="#arg-densitytemplates"></a></dt>
<dd><p>A list of length 3 with templates for the p-value
density plots (variables from <code>pvalueVars</code>), the continuous
variables density plots (variables from <code>densityVars</code>), and Manhattan
plots for the p-value variables (<code>pvalueVars</code>). These templates
are processed by <a href="https://rdrr.io/pkg/whisker/man/whisker.render.html" class="external-link">whisker.render</a>. Check the default templates
for more information. The <code>densityTemplates</code> argument is available for
those users interested in customizing these plots. For example, to show
histograms instead of density plots use <code>templatePvalueHistogram</code> and
<code>templateHistogram</code> instead of <code>templatePvalueDensity</code> and
<code>templateDensity</code> respectively.</p></dd>


<dt id="arg-template">template<a class="anchor" aria-label="anchor" href="#arg-template"></a></dt>
<dd><p>Template file to use for the report. If not provided, will
use the default file found in regionExploration/regionExploration.Rmd
within the package source.</p></dd>


<dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>A ggplot2 <a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a> to use for the plots made with
ggplot2.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>The number of digits to round to in the interactive table of
the top <code>nBestRegions</code>. Note that p-values and adjusted p-values won't
be rounded.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to other methods and/or advanced arguments.
Advanced arguments:</p><dl><dt>overviewParams </dt>
<dd><p>A two element list with <code>base_size</code> and
<code>areaRel</code> that control the text size for the genomic overview plots.</p></dd>

<dt>output_format </dt>
<dd><p>Either <code>html_document</code>, <code>pdf_document</code> or
<code><a href="https://rdrr.io/pkg/knitrBootstrap/man/bootstrap_document.html" class="external-link">knitrBootstrap::bootstrap_document</a></code> unless you modify the YAML
template.</p></dd>

<dt>clean </dt>
<dd><p>Logical, whether to clean the results or not. Passed to
<a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a>.</p></dd>


</dl></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An HTML report with a basic exploration for the given set of
genomic regions. See the example report at
<a href="http://leekgroup.github.io/regionReport/reference/renderReport-example/regionExploration.html" class="external-link">http://leekgroup.github.io/regionReport/reference/renderReport-example/regionExploration.html</a>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Set <code>output_format</code> to <code>'knitrBootstrap::bootstrap_document'</code> or
<code>'pdf_document'</code> if you want a HTML report styled by knitrBootstrap or
a PDF report respectively. If using knitrBootstrap, we recommend the version
available only via GitHub at <a href="https://github.com/jimhester/knitrBootstrap" class="external-link">https://github.com/jimhester/knitrBootstrap</a>
which has nicer features than the current version available via CRAN. You can
also set the <code>output_format</code> to <code>'html_document'</code> for a HTML
report styled by rmarkdown. The default is set to
<code>'BiocStyle::html_document'</code>.</p>
<p>If you modify the YAML front matter of <code>template</code>, you can use other
values for <code>output_format</code>.</p>
<p>The HTML report styled with knitrBootstrap can be smaller in size than the
<code>'html_document'</code> report.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Leonardo Collado-Torres</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load derfinder for an example set of regions</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lcolladotor/derfinder" class="external-link">"derfinder"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="va">genomeRegions</span><span class="op">$</span><span class="va">regions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Assign chr length</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">"GenomicRanges"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr21"</span> <span class="op">=</span> <span class="fl">48129895</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The output will be saved in the 'renderReport-example' directory</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"renderReport-example"</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate the HTML report</span></span></span>
<span class="r-in"><span><span class="va">report</span> <span class="op">&lt;-</span> <span class="fu">renderReport</span><span class="op">(</span><span class="va">regions</span>, <span class="st">"Example run"</span>,</span></span>
<span class="r-in"><span>    pvalueVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Q-values"</span> <span class="op">=</span> <span class="st">"qvalues"</span>, <span class="st">"P-values"</span> <span class="op">=</span> <span class="st">"pvalues"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, densityVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Area"</span> <span class="op">=</span> <span class="st">"area"</span>, <span class="st">"Mean coverage"</span> <span class="op">=</span> <span class="st">"meanCoverage"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    significantVar <span class="op">=</span> <span class="va">regions</span><span class="op">$</span><span class="va">qvalues</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>, nBestRegions <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    outdir <span class="op">=</span> <span class="st">"renderReport-example"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing 11 Bibtex entries ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Results written to file 'renderReport-example/regionExploration.bib'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> processing file: regionExploration.Rmd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2/43 [docSetup]              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4/43 [setup]                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6/43 [pvaluePlots]           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8/43 [regLen]                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10/43 [regLen2]               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12/43 [densityPlots]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14/43 [genomeOverview1]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16/43 [manhattanPlots]        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18/43 [genomeOverview2]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20/43 [annoReg]               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22/43 [genomeOverview3]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24/43 [countTable]            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26/43 [vennDiagram]           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28/43 [vennDiagramSignificant]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30/43 [bestRegionInfo]        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32/43 [unnamed-chunk-1]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34/43 [thecall]               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36/43 [reproducibility1]      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38/43 [reproducibility2]      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40/43 [reproducibility3]      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42/43 [bibliography]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43/43                         </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> output file: regionExploration.knit.md</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> /usr/bin/pandoc +RTS -K512m -RTS regionExploration.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output regionExploration.html --lua-filter /__w/_temp/Library/bookdown/rmarkdown/lua/custom-environment.lua --lua-filter /usr/local/lib/R/site-library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /usr/local/lib/R/site-library/rmarkdown/rmarkdown/lua/latex-div.lua --lua-filter /usr/local/lib/R/site-library/rmarkdown/rmarkdown/lua/table-classes.lua --embed-resources --standalone --wrap preserve --variable bs3=TRUE --section-divs --table-of-contents --toc-depth 3 --variable toc_float=1 --variable toc_selectors=h1,h2,h3 --variable toc_collapsed=1 --variable toc_smooth_scroll=1 --variable toc_print=1 --template /tmp/RtmpNRm6dJ/BiocStyle/template.html --no-highlight --variable highlightjs=1 --number-sections --variable theme=bootstrap --css /__w/_temp/Library/BiocStyle/resources/html/bioconductor.css --mathjax --variable 'mathjax-url=https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' --include-in-header /tmp/RtmpNRm6dJ/rmarkdown-str2d5e1cd0c13f.html --variable code_folding=hide --variable code_menu=1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Output created: regionExploration.html</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## Browse the report</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/browseURL.html" class="external-link">browseURL</a></span><span class="op">(</span><span class="va">report</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## See the example report at</span></span></span>
<span class="r-in"><span><span class="co">## http://leekgroup.github.io/regionReport/reference/renderReport-example/regionExploration.html</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Check the default templates. For users interested in customizing these</span></span></span>
<span class="r-in"><span><span class="co">## plots.</span></span></span>
<span class="r-in"><span><span class="co">## For p-value variables:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu">regionReport</span><span class="fu">::</span><span class="va">templatePvalueDensity</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## {{{densityVarName}}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```{r pval-density-{{{varName}}}, fig.width=10, fig.height=10}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1{{{varName}}} &lt;- ggplot(regions.df.plot, aes(x={{{varName}}}, colour=seqnames)) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     geom_line(stat='density') + xlim(0, 1) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     labs(title='Density of {{{densityVarName}}}') + xlab('{{{densityVarName}}}') +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     scale_colour_discrete(limits=chrs) + theme(legend.title=element_blank())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1{{{varName}}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```{r 'pval-summary-{{{varName}}}'}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> summary(mcols(regions)[['{{{varName}}}']])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This is the numerical summary of the distribution of the {{{densityVarName}}}.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```{r pval-tableSummary-{{{varName}}}, results='asis'}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {{{varName}}}table &lt;- lapply(c(1e-04, 0.001, 0.01, 0.025, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.6, 0.7, 0.8, 0.9, 1), function(x) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     data.frame('Cut' = x, 'Count' = sum(mcols(regions)[['{{{varName}}}']] &lt;= x))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {{{varName}}}table &lt;- do.call(rbind, {{{varName}}}table)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> if(outputIsHTML) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     kable({{{varName}}}table, format = 'markdown', align = c('c', 'c'))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> } else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     kable({{{varName}}}table)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This table shows the number of regions with {{{densityVarName}}} less or equal than some commonly used cutoff values.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## For continous variables:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu">regionReport</span><span class="fu">::</span><span class="va">templateDensity</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## {{{densityVarName}}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```{r density-{{{varName}}}, fig.width=14, fig.height=14, eval=hasSignificant, echo=hasSignificant}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xrange &lt;- range(regions.df.plot[, '{{{varName}}}']) * c(0.95, 1.05)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p3a{{{varName}}} &lt;- ggplot(regions.df.plot[is.finite(regions.df.plot[, '{{{varName}}}']), ], aes(x={{{varName}}}, colour=seqnames)) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     geom_line(stat='density') + labs(title='Density of {{{densityVarName}}}') +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xlab('{{{densityVarName}}}') + scale_colour_discrete(limits=chrs) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xlim(xrange) + theme(legend.title=element_blank())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p3b{{{varName}}} &lt;- ggplot(regions.df.sig[is.finite(regions.df.sig[, '{{{varName}}}']), ], aes(x={{{varName}}}, colour=seqnames)) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     geom_line(stat='density') +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     labs(title='Density of {{{densityVarName}}} (significant only)') +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xlab('{{{densityVarName}}}') + scale_colour_discrete(limits=chrs) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xlim(xrange) + theme(legend.title=element_blank())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grid.arrange(p3a{{{varName}}}, p3b{{{varName}}})</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```{r density-solo-{{{varName}}}, fig.width=10, fig.height=10, eval=!hasSignificant, echo=!hasSignificant}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p3a{{{varName}}} &lt;- ggplot(regions.df.plot[is.finite(regions.df.plot[, '{{{varName}}}']), ], aes(x={{{varName}}}, colour=seqnames)) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     geom_line(stat='density') + labs(title='Density of {{{densityVarName}}}') +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xlab('{{{densityVarName}}}') + scale_colour_discrete(limits=chrs) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     theme(legend.title=element_blank())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p3a{{{varName}}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This plot shows the density of the {{{densityVarName}}} for all regions. `r ifelse(hasSignificant, 'The bottom panel is restricted to significant regions.', '')`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## For Manhattan plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu">regionReport</span><span class="fu">::</span><span class="va">templateManhattan</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ## Manhattan {{{densityVarName}}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```{r manhattan-{{{varName}}}, fig.width=10, fig.height=10, message = FALSE}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> regions.manhattan &lt;- regions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mcols(regions.manhattan)[['{{{varName}}}']] &lt;- - log(mcols(regions.manhattan)[['{{{varName}}}']], base = 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pMan{{{varName}}} &lt;- plotGrandLinear(regions.manhattan, aes(y = {{{varName}}}, colour = seqnames)) + theme(axis.text.x=element_text(angle=-90, hjust=0)) + ylab('-log10 {{{densityVarName}}}')</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pMan{{{varName}}}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rm(regions.manhattan)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ```</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This is a Manhattan plot for the {{{densityVarName}}} for all regions. A single dot is shown for each region, where higher values in the y-axis mean that the {{{densityVarName}}} are closer to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##################################################</span></span></span>
<span class="r-in"><span><span class="co">## bumphunter example mentioned in the vignette ##</span></span></span>
<span class="r-in"><span><span class="co">##################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load bumphunter</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rafalab/bumphunter" class="external-link">"bumphunter"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create data from the vignette</span></span></span>
<span class="r-in"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    pos1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1000</span>, <span class="fl">35</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pos2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2001</span>, <span class="fl">3000</span>, <span class="fl">35</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pos3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1000</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pos</span>, <span class="va">length</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pos</span>, use.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Find clusters</span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bumphunter/man/clusterMaker.html" class="external-link">clusterMaker</a></span><span class="op">(</span><span class="va">chr</span>, <span class="va">pos</span>, maxGap <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Build simulated bumps</span></span></span>
<span class="r-in"><span><span class="va">Indexes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/splitAsList.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>, <span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">Indexes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">ind</span> <span class="op">&lt;-</span> <span class="va">Indexes</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">pos</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">beta1</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">*</span> <span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="co">## multiply by i to vary size</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Build data</span></span></span>
<span class="r-in"><span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">pos</span> <span class="op">/</span> <span class="fl">720</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">23852577</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html" class="external-link">%x%</a></span> <span class="va">beta0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html" class="external-link">%x%</a></span> <span class="va">beta1</span> <span class="op">+</span> <span class="va">error</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform bumphunting</span></span></span>
<span class="r-in"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bumphunter/man/bumphunter.html" class="external-link">bumphunter</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, <span class="va">chr</span>, <span class="va">pos</span>, <span class="va">cl</span>, cutoff <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [bumphunterEngine] Using a single core (backend: doSEQ, version: 1.5.2).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [bumphunterEngine] Computing coefficients.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [bumphunterEngine] Finding regions.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [bumphunterEngine] Found 15 bumps.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Explore data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tab</span>, <span class="va">head</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     chr start  end      value       area cluster indexStart indexEnd  L clusterL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 chr1  2316 2631 -1.5814747 15.8147473       2         39       48 10       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  chr2   451  551  1.5891293  4.7673878       3         68       70  3       20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  chr1   456  526  1.0678828  3.2036485       1         14       16  3       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  chr1  2176 2211  0.7841794  1.5683589       2         35       36  2       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  chr1  2841 2841  1.2010184  1.2010184       2         54       54  1       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  chr1   771  771  0.7780902  0.7780902       1         23       23  1       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.60960932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.09052769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.21482638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.13053755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.21723642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.39934961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fitted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.60960932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.09052769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.21482638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.13053755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.21723642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.39934961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pvaluesMarginal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.org/packages/GenomicRanges" class="external-link">"GenomicRanges"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Build GRanges with sequence lengths</span></span></span>
<span class="r-in"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    seqnames <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">chr</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">start</span>, end <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">end</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    strand <span class="op">=</span> <span class="st">"*"</span>, value <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">value</span>, area <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">area</span>,</span></span>
<span class="r-in"><span>    cluster <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">cluster</span>, L <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">L</span>, clusterL <span class="op">=</span> <span class="va">tab</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">clusterL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Assign chr lengths</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/getChromInfoFromUCSC.html" class="external-link">getChromInfoFromUCSC</a></span><span class="op">(</span><span class="st">"hg19"</span>, as.Seqinfo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">[</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Explore the regions</span></span></span>
<span class="r-in"><span><span class="va">regions</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GRanges object with 15 ranges and 5 metadata columns:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        seqnames    ranges strand |     value      area   cluster         L  clusterL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [1]     chr1 2316-2631      * | -1.581475  15.81475         2        10        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [2]     chr2   451-551      * |  1.589129   4.76739         3         3        20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [3]     chr1   456-526      * |  1.067883   3.20365         1         3        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [4]     chr1 2176-2211      * |  0.784179   1.56836         2         2        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    [5]     chr1      2841      * |  1.201018   1.20102         2         1        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ...      ...       ...    ... .       ...       ...       ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [11]     chr1       631      * |  0.618603  0.618603         1         1        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [12]     chr1         1      * |  0.609609  0.609609         1         1        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [13]     chr1      2911      * | -0.576423  0.576423         2         1        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [14]     chr2       251      * | -0.556160  0.556160         3         1        20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [15]     chr1      2806      * | -0.521606  0.521606         2         1        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seqinfo: 2 sequences from an unspecified genome</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now create the report</span></span></span>
<span class="r-in"><span><span class="va">report</span> <span class="op">&lt;-</span> <span class="fu">renderReport</span><span class="op">(</span><span class="va">regions</span>, <span class="st">"Example bumphunter"</span>,</span></span>
<span class="r-in"><span>    pvalueVars <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    densityVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Area"</span> <span class="op">=</span> <span class="st">"area"</span>, <span class="st">"Value"</span> <span class="op">=</span> <span class="st">"value"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"Cluster Length"</span> <span class="op">=</span> <span class="st">"clusterL"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, significantVar <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    output <span class="op">=</span> <span class="st">"bumphunter-example"</span>, outdir <span class="op">=</span> <span class="st">"bumphunter-example"</span>,</span></span>
<span class="r-in"><span>    device <span class="op">=</span> <span class="st">"png"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing 11 Bibtex entries ... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> OK</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Results written to file 'bumphunter-example/bumphunter-example.bib'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> processing file: bumphunter-example.Rmd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2/43 [docSetup]              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4/43 [setup]                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6/43 [pvaluePlots]           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8/43 [regLen]                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10/43 [regLen2]               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12/43 [densityPlots]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14/43 [genomeOverview1]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16/43 [manhattanPlots]        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18/43 [genomeOverview2]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20/43 [annoReg]               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22/43 [genomeOverview3]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24/43 [countTable]            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26/43 [vennDiagram]           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28/43 [vennDiagramSignificant]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30/43 [bestRegionInfo]        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32/43 [unnamed-chunk-1]       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34/43 [thecall]               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36/43 [reproducibility1]      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38/43 [reproducibility2]      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40/43 [reproducibility3]      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41/43                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42/43 [bibliography]          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43/43                         </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> output file: bumphunter-example.knit.md</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> /usr/bin/pandoc +RTS -K512m -RTS bumphunter-example.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output bumphunter-example.html --lua-filter /__w/_temp/Library/bookdown/rmarkdown/lua/custom-environment.lua --lua-filter /usr/local/lib/R/site-library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /usr/local/lib/R/site-library/rmarkdown/rmarkdown/lua/latex-div.lua --lua-filter /usr/local/lib/R/site-library/rmarkdown/rmarkdown/lua/table-classes.lua --embed-resources --standalone --wrap preserve --variable bs3=TRUE --section-divs --table-of-contents --toc-depth 3 --variable toc_float=1 --variable toc_selectors=h1,h2,h3 --variable toc_collapsed=1 --variable toc_smooth_scroll=1 --variable toc_print=1 --template /tmp/RtmpNRm6dJ/BiocStyle/template.html --no-highlight --variable highlightjs=1 --number-sections --variable theme=bootstrap --css /__w/_temp/Library/BiocStyle/resources/html/bioconductor.css --mathjax --variable 'mathjax-url=https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' --include-in-header /tmp/RtmpNRm6dJ/rmarkdown-str2d5e4a7f550d.html --variable code_folding=hide --variable code_menu=1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Output created: bumphunter-example.html</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## See the example report at</span></span></span>
<span class="r-in"><span><span class="co">## http://leekgroup.github.io/regionReport/reference/bumphunter-example/bumphunter-example.html</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Leonardo Collado-Torres, Andrew E. Jaffe, Jeffrey T. Leek.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

